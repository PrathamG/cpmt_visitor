/*
 *  Kuma Gauge - v0.2
 *
 *  Made by Sam Bellen for Kunstmaan
 *   - http:// www.kunstmaan.be
 *   - http:// www.sambellen.be
 *
 *  Under MIT License
 */
(function(e,t,n,r){function s(t,n,r){var s=this;s.element=t;s.$element=e(t);s.config=e.extend({},i,n);s._config=i;s.method=r;s.gauge={};s.init()}var i={radius:80,paddingX:40,paddingY:40,gaugeWidth:30,fill:"0-#1cb42f:0-#fdbe37:50-#fa4133:100",gaugeBackground:"#f4f4f4",background:"#fff",showNeedle:true,animationSpeed:500,width:0,height:0,centerX:0,centerY:0,min:0,max:100,value:80,valueLabel:{display:true,fontFamily:"Arial",fontColor:"#000",fontSize:"20",fontWeight:"normal"},title:{display:true,value:"",fontFamily:"Arial",fontColor:"#000",fontSize:"20",fontWeight:"normal"},label:{display:true,left:"Low",right:"High",fontFamily:"Arial",fontColor:"#000",fontSize:"12",fontWeight:"normal"}};Raphael.fn.arc=function(e,t,n,r,i,s,o){var u=[i,s,o,0,1,n,r].join(" ");return this.path("M"+e+" "+t+" a "+u)};Raphael.fn.circularArc=function(e,t,n,r,i){var s=e+n*Math.cos(r*Math.PI/180);var o=t+n*Math.sin(r*Math.PI/180);var u=e+n*Math.cos(i*Math.PI/180);var a=t+n*Math.sin(i*Math.PI/180);return this.arc(s,o,u-s,a-o,n,n,0)};s.prototype={init:function(){_this=this;if(!_this.method){_this.draw()}},_setup:function(){_this=this;_this.config.width=_this.config.radius*2+_this.config.paddingX*2;_this.config.height=_this.config.radius+_this.config.paddingY*2;_this.config.centerX=_this.config.paddingX+_this.config.radius;_this.config.centerY=_this.config.paddingY+_this.config.radius;if(typeof e(this).attr("id")==="undefined"||e(this).attr("id")===""){_this.config.id="gauge-"+e('*[id^="gauge-"]').length;_this.$element.attr("id",_this.config.id)}},_calculateRotation:function(e,t,n){var r,i;r=t-e;if(n<t&&n>e){i=180*((n-e)/r)}else if(n<=e){i=0}else{i=180}return i},draw:function(){var e=this;e._setup();e.gauge=new Raphael(e.config.id,e.config.width,e.config.height);e.gauge.gauge=e.gauge.circularArc(e.config.centerX,e.config.centerY,e.config.radius,180,0);e.gauge.gauge.attr({fill:e.config.fill,stroke:"none"});e.gauge.gauge.node.setAttribute("class","gauge");e.gauge.gaugeBackground=e.gauge.circularArc(e.config.centerX,e.config.centerY,e.config.radius,180,0);e.gauge.gaugeBackground.attr({fill:e.config.gaugeBackground,stroke:"none"});e.gauge.gaugeBackground.node.setAttribute("class","gauge__background");e.gauge.centerArc=e.gauge.circularArc(e.config.centerX,e.config.centerY,e.config.radius-e.config.gaugeWidth,180,0);e.gauge.centerArc.attr({fill:e.config.background,stroke:"none"});e.gauge.centerArc.node.setAttribute("class","gauge__center");if(e.config.showNeedle){e.gauge.needle=e.gauge.rect(e.config.centerX,e.config.paddingY,1,40);e.gauge.needle.attr({fill:"#000",stroke:"none"});e.gauge.needle.node.setAttribute("class","gauge__needle")}e.gauge.bottomMask=e.gauge.rect(0,e.config.centerY,e.config.width,40);e.gauge.bottomMask.attr({fill:e.config.background,stroke:"none"});if(e.config.valueLabel.display){if(e.config.showNeedle){e.gauge.valueLabel=e.gauge.text(e.config.centerX,e.config.centerY-10,Math.round((e.config.max-e.config.min)/2))}else{e.gauge.valueLabel=e.gauge.text(e.config.centerX,e.config.centerY-10,e.config.value)}e.gauge.valueLabel.attr({fill:e.config.valueLabel.fontColor,"font-size":e.config.valueLabel.fontSize,"font-family":e.config.valueLabel.fontColor,"font-weight":e.config.valueLabel.fontWeight});e.gauge.valueLabel.node.setAttribute("class","gauge__value")}if(e.config.title.display){e.gauge.title=e.gauge.text(e.config.centerX,e.config.paddingY-5,e.config.title.value);e.gauge.title.attr({fill:e.config.title.fontColor,"fill-opacity":0,"font-size":e.config.title.fontSize,"font-family":e.config.title.fontFamily,"font-weight":e.config.title.fontWeight});e.gauge.title.node.setAttribute("class","gauge__title")}if(e.config.label.display){e.gauge.leftLabel=e.gauge.text(e.config.gaugeWidth/2+e.config.paddingX,e.config.centerY+10,e.config.label.left);e.gauge.leftLabel.attr({fill:e.config.title.fontColor,"fill-opacity":0,"font-size":e.config.label.fontSize,"font-family":e.config.label.fontFamily,"font-weight":e.config.label.fontWeight});e.gauge.leftLabel.node.setAttribute("class","gauge__label--left");e.gauge.rightLabel=e.gauge.text(e.config.width-e.config.gaugeWidth/2-e.config.paddingX,e.config.centerY+10,e.config.label.right);e.gauge.rightLabel.attr({fill:e.config.title.fontColor,"fill-opacity":0,"font-size":e.config.label.fontSize,"font-family":e.config.label.fontFamily,"font-weight":e.config.label.fontWeight});e.gauge.rightLabel.node.setAttribute("class","gauge__label--right")}setTimeout(function(){if(e.config.valueLabel.display){e.gauge.valueLabel.attr("y",e.config.centerY-10); e.gauge.valueLabel.attr("x", 74)}if(e.config.title.display){e.gauge.title.attr({y:e.config.paddingY-e.gauge.title.getBBox().height/2,"fill-opacity":1})}if(e.config.label.display){e.gauge.leftLabel.attr({y:e.config.centerY+e.gauge.leftLabel.getBBox().height/2,"fill-opacity":1});e.gauge.rightLabel.attr({y:e.config.centerY+e.gauge.rightLabel.getBBox().height/2,"fill-opacity":1})}},1e3);e.gauge.gaugeBackground.animate({transform:"r"+e._calculateRotation(e.config.min,e.config.max,e.config.value)+","+e.config.centerX+","+e.config.centerY},e.config.animationSpeed,"<>")},update:function(e){var t=this;var n=function(e,n,r){t.config.min=e;t.config.max=n;t.config.value=r;t.gauge.gaugeBackground.animate({transform:"r"+t._calculateRotation(e,n,r)+","+t.config.centerX+","+t.config.centerY},t.config.animationSpeed,"<>");if(t.config.valueLabel.display){if(t.config.showNeedle){t.gauge.valueLabel.attr("text",r)}else{t.gauge.valueLabel.attr("text",(n-e)/2)}}};if(typeof e.min!=="undefined"&&typeof e.max!=="undefined"&&typeof e.value!=="undefined"){n(e.min,e.max,e.value)}else if(typeof e.value!=="undefined"){n(t.config.min,t.config.max,e.value)}}};e.fn.kumaGauge=function(t,n){var r=t,i=arguments,o=this;if(typeof r!=="string"){if(i.length===1){n=r;t=false;return this.each(function(){if(!e.data(this,"kumaGauge")){e.data(this,"kumaGauge",new s(this,n,t))}})}}else{return this.each(function(){if(typeof e.data(this,"kumaGauge")[t]==="function"){e.data(this,"kumaGauge")[t](n)}})}}})(jQuery,window,document)
